# 心印助记字计算过程

## 术语表

- **心印（Heartprint）**：只有用户自己知道的一句话，用于密钥派生和字表生成，是本方案的安全根基。
- **基础字集（Primary Charset）**：用于编码的汉字池，取自通用规范汉字表。
- **心印字表（Mnemonic Charset）**：由心印和基础字集确定的有序汉字集合。
- **心印助记字**：用于表示加密密钥的32个汉字。
- **原始密钥（Raw Key）**：Solana 钱包生成的原始32字节密钥。
- **加密密钥（Encrypted Key）**：用心印派生的AES密钥和IV加密后的32字节密钥。

---

## 简明说明

本方案用于安全保存和还原 Solana 钱包密钥，核心依赖用户自定义的**心印**（Heartprint）。其关键步骤如下：

1. **基础字集（Primary Charset）**：从《通用规范汉字表》中选定一段连续汉字，作为编码候选池。
2. **心印字表（Mnemonic Charset）**：使用心印派生随机种子，通过算法从基础字集中无重复随机选出256个汉字，顺序排列，得到心印字表。
3. **加密与编码**：
   - 用操作系统级随机源生成32字节**原始密钥（Raw Key）**。
   - 以心印为基础，派生AES密钥和IV，对原始密钥加密，得到32字节**加密密钥（Encrypted Key）**。
   - 将加密密钥的每个字节，作为索引在心印字表中查找对应汉字，得到32个**心印助记字**。
4. **还原流程**：只需记住心印、基础字集的起始位置与长度、32个心印助记字，即可完整还原并解密 Solana 钱包密钥。
